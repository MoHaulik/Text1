<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Realtime Test</title>
    <!-- Inkluder Firebase-libraries via CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-database-compat.js"></script>
</head>
<body>
    <h1>Live Text Copier</h1>
    <button id="loginButton">Log ind med Google</button>
    <textarea id="textInput" placeholder="Skriv noget her..."></textarea>
    <br>
    <button onclick="copyText()">Kopier</button>
    <p id="status"></p>

    <script>
      // Firebase-konfiguration
      const firebaseConfig = {
          apiKey: "AIzaSyAoY_XxClJRTUS6OJmaIDvZm014Lx7sXA4",
          authDomain: "copypaste2000-5776c.firebaseapp.com",
          databaseURL: "https://copypaste2000-5776c-default-rtdb.firebaseio.com",
          projectId: "copypaste2000-5776c",
          storageBucket: "copypaste2000-5776c.appspot.com",
          messagingSenderId: "733249598043",
          appId: "1:733249598043:web:6648bfe9b408127aa6457e",
          measurementId: "G-M16KES53R6"
      };

      // Initialiser Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const database = firebase.database();

      // Google Sign-in med Popup
      document.getElementById('loginButton').addEventListener('click', () => {
          console.log("Login-knap klikket");
          const provider = new firebase.auth.GoogleAuthProvider();

          auth.signInWithPopup(provider)
              .then((result) => {
                  console.log("Bruger logget ind:", result.user.displayName);
                  alert(`Velkommen, ${result.user.displayName}!`);
              })
              .catch((error) => {
                  console.error("Login-fejl:", error.message);
                  alert("Login fejlede: " + error.message);
              });
      });

      // Reference til Realtime Database
      const textRef = database.ref('sharedText');

      // Lyt efter ændringer og opdater tekstfeltet
      textRef.on('value', (snapshot) => {
          const text = snapshot.val();
          document.getElementById('textInput').value = text || '';
      });

      // Opdater database, når der skrives i tekstfeltet
      const textArea = document.getElementById('textInput');
      textArea.addEventListener('input', () => {
          const value = textArea.value;
          textRef.set(value);
      });

      // Kopier tekst til clipboard
      function copyText() {
          const textArea = document.getElementById('textInput');
          textArea.select();
          document.execCommand('copy');
          document.getElementById('status').innerText = "Tekst kopieret!";
          setTimeout(() => {
              document.getElementById('status').innerText = "";
          }, 2000);
      }
    </script>
</body>
</html>
